<div class="flex flex-col w-150">
  <%if @cart.product_in_carts.empty?%>
    <div class="text-zinc-400 p-8 font-bold text-center item-center flex flex-row gap-3 justify-center">
      <p class=" text-lg"> Your bag is empty </p>
      <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" class="size-8">
        <path stroke-linecap="round" stroke-linejoin="round" d="M15.182 16.318A4.486 4.486 0 0 0 12.016 15a4.486 4.486 0 0 0-3.198 1.318M21 12a9 9 0 1 1-18 0 9 9 0 0 1 18 0ZM9.75 9.75c0 .414-.168.75-.375.75S9 10.164 9 9.75 9.168 9 9.375 9s.375.336.375.75Zm-.375 0h.008v.015h-.008V9.75Zm5.625 0c0 .414-.168.75-.375.75s-.375-.336-.375-.75.168-.75.375-.75.375.336.375.75Zm-.375 0h.008v.015h-.008V9.75Z" />
      </svg>
    </div>
  <%else%>
    <%@cart.product_in_carts.each do |pic| %>
      <div class="flex flex-row py-2">
        
        <%product = pic.product%>
        <%= form_with url: remove_from_cart_path(pic.id), method: :post do |form|%>

          <%= form.hidden_field :id, value: pic.id %>
          <button class="text-red-600 hover:text-red-800 text-center p-3 py-6" type="submit">
            <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="size-7">
              <path stroke-linecap="round" stroke-linejoin="round" d="m14.74 9-.346 9m-4.788 0L9.26 9m9.968-3.21c.342.052.682.107 1.022.166m-1.022-.165L18.16 19.673a2.25 2.25 0 0 1-2.244 2.077H8.084a2.25 2.25 0 0 1-2.244-2.077L4.772 5.79m14.456 0a48.108 48.108 0 0 0-3.478-.397m-12 .562c.34-.059.68-.114 1.022-.165m0 0a48.11 48.11 0 0 1 3.478-.397m7.5 0v-.916c0-1.18-.91-2.164-2.09-2.201a51.964 51.964 0 0 0-3.32 0c-1.18.037-2.09 1.022-2.09 2.201v.916m7.5 0a48.667 48.667 0 0 0-7.5 0" />
            </svg>
          </button>
        <%end%>
        <div class="flex flex-row w-100" data-controller="amount">

          <%= image_tag product.featured_image, class:'h-20 w-20 rounded-xl' if product.featured_image.attached? %>
          <div class="flex flex-col px-3" data-controller="amount">
            
            <%= product.name%>
            <%= form_with url: directly_update_cart_path(product.id), method: :post, data: { controller: "amount", amount_target: "form" } do |form| %>

              <% form.hidden_field :id, value: product&.id%>
              <div class="max-w-sm relative mt-4 mb-4" >
                <div class="relative">
                  <div class="relative flex items-center">
                    
                    <button type="button" id="decrement-button" data-input-counter-decrement="counter-input" data-action="click->amount#submit_upon_decrease" class="shrink-0 bg-gray-100 dark:bg-gray-700 dark:hover:bg-gray-600 dark:border-gray-600 hover:bg-gray-200 inline-flex items-center justify-center border border-gray-300 rounded-md h-5 w-5 focus:ring-gray-100 dark:focus:ring-gray-700 focus:ring-2 focus:outline-none">
                      <svg class="w-2.5 h-2.5 text-gray-900 dark:text-white" aria-hidden="true" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 18 2">
                        <path stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M1 1h16"/>
                      </svg>
                    </button>
                    <input type="text" id="counter-input" name="quantity" data-input-counter data-amount-target="output"  class="shrink-0 text-gray-900  border-0 bg-transparent text-sm font-normal focus:outline-none focus:ring-0 max-w-[2.5rem] text-center" placeholder="" value="<%=pic.quantity%>" required />
                    <button type="button" id="increment-button" data-input-counter-increment="counter-input" data-action="click->amount#submit_upon_increase" class="shrink-0 bg-gray-100 dark:bg-gray-700 dark:hover:bg-gray-600 dark:border-gray-600 hover:bg-gray-200 inline-flex items-center justify-center border border-gray-300 rounded-md h-5 w-5 focus:ring-gray-100 dark:focus:ring-gray-700 focus:ring-2 focus:outline-none">
                      <svg class="w-2.5 h-2.5 text-gray-900 dark:text-white" aria-hidden="true" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 18 18">
                          <path stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 1v16M1 9h16"/>
                      </svg>
                    </button>
                  </div>
                </div>
              </div>
            <%end%>
          </div>
        </div>
        <div class="absolute flex flex-col py-2 right-4">
          <div class="text-zinc-400"> 
            <%= product.sales_price%> x <%= pic.quantity%>
          </div>
          <div class="text-zinc-600 text-right">
            <%= pic.total%>
          </div>
        </div>
        
      </div>
    <%end%>
    <div class="flex flex-row justify-end py-2 pr-4 gap-3 text-zinc-600">
      <p class="font-bold">Total: </p>
      <%= @cart.total%>
    </div>
    <%=link_to "CHECKOUT" %>
  <%end%>
</div>